<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>今日头条</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Nativeism Reset & Utilities */
        body {
            font-family: -apple-system, "PingFang SC", "Helvetica Neue", "Microsoft YaHei", sans-serif;
            background-color: #FFFFFF;
            color: #222222;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: none; /* Prevent pull-to-refresh on body */
        }

        /* Hide Scrollbar but keep functionality */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Toutiao Red */
        .text-toutiao { color: #F85959; }
        .bg-toutiao { background-color: #F85959; }
        .border-toutiao { border-color: #F85959; }

        /* Text Colors */
        .text-title { color: #222222; }
        .text-body { color: #505050; }
        .text-meta { color: #999999; }
        .border-sep { border-color: #E8E8E8; }

        /* Line Clamp */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Animations */
        .page-transition {
            transition: transform 0.25s cubic-bezier(0.1, 0.7, 0.1, 1);
        }
        .slide-in {
            transform: translateX(0%);
        }
        .slide-out {
            transform: translateX(100%);
        }
        
        /* Tab Active State */
        .tab-active {
            color: #F85959;
            font-weight: 600;
        }
        .tab-inactive {
            color: #222222;
        }

        /* Channel Active State */
        .channel-active {
            color: #F85959;
            font-size: 17px;
            font-weight: 600;
        }
        .channel-inactive {
            color: #222222;
            font-size: 16px;
        }
    </style>

<script>
(function() {
  console.log('[Proxy Script] HTML 已加载，当前URL:', window.location.href);
  console.log('[Proxy Script] 相对路径链接会自动通过代理服务器获取签名URL');
})();
</script></head>
<body class="bg-white h-screen w-full overflow-hidden flex flex-col">

    <!-- ==================== APP SHELL ==================== -->
    
    <!-- MAIN VIEW CONTAINER -->
    <div id="main-container" class="flex-1 relative w-full overflow-hidden">
        
        <!-- 1. HOME VIEW -->
        <div id="view-home" class="absolute inset-0 flex flex-col bg-white z-10">
            <!-- Top Search Bar -->
            <div class="px-4 py-2 bg-[#D43D3D] flex items-center gap-3">
                <div class="flex-1 bg-white rounded-[4px] h-9 flex items-center px-3 gap-2" onclick="openSearch()">
                    <i class="fa-solid fa-magnifying-glass text-gray-400 text-sm"></i>
                    <span class="text-sm text-gray-400">搜索感兴趣的内容</span>
                </div>
                <div class="text-white text-sm font-medium">发布</div>
            </div>

            <!-- Channel Scroll -->
            <div class="border-b border-sep bg-white relative">
                <div class="flex overflow-x-auto no-scrollbar px-2 py-2.5 items-baseline gap-6" id="channel-list">
                    <!-- Channels injected by JS -->
                </div>
                <!-- Gradient fade for scroll hint -->
                <div class="absolute right-0 top-0 bottom-0 w-8 bg-gradient-to-l from-white to-transparent pointer-events-none"></div>
                <div class="absolute right-0 top-0 bottom-0 w-10 bg-white flex items-center justify-center shadow-[-5px_0_10px_rgba(0,0,0,0.05)]">
                    <i class="fa-solid fa-plus text-gray-600 text-sm"></i>
                </div>
            </div>

            <!-- Feed List -->
            <div class="flex-1 overflow-y-auto no-scrollbar" id="home-feed">
                <!-- Pull to refresh spinner (hidden by default) -->
                <div class="h-12 flex items-center justify-center text-gray-400 text-xs hidden" id="refresh-spinner">
                    <i class="fa-solid fa-circle-notch fa-spin mr-2 text-toutiao"></i> 推荐中...
                </div>
                <!-- Feed Items injected by JS -->
            </div>
        </div>

        <!-- 2. VIDEO VIEW -->
        <div id="view-video" class="absolute inset-0 flex flex-col bg-black hidden z-10">
            <div class="px-4 py-3 bg-black/90 text-white flex justify-between items-center sticky top-0 z-20">
                <div class="font-bold text-lg">西瓜视频</div>
                <i class="fa-solid fa-magnifying-glass"></i>
            </div>
            <div class="flex-1 overflow-y-auto no-scrollbar bg-[#1a1a1a]" id="video-feed">
                <!-- Video items -->
            </div>
        </div>

        <!-- 3. MICRO-HEADLINES VIEW -->
        <div id="view-micro" class="absolute inset-0 flex flex-col bg-[#F4F5F6] hidden z-10">
            <div class="bg-white px-4 py-3 border-b border-sep sticky top-0 z-20 flex justify-between items-center">
                <div class="font-bold text-lg">微头条</div>
                <div class="text-toutiao text-sm font-medium"><i class="fa-solid fa-pen-to-square mr-1"></i>发布</div>
            </div>
            <div class="flex-1 overflow-y-auto no-scrollbar" id="micro-feed">
                <!-- Micro items -->
            </div>
        </div>

        <!-- 4. PROFILE VIEW -->
        <div id="view-profile" class="absolute inset-0 flex flex-col bg-[#F4F5F6] hidden z-10">
            <!-- Header -->
            <div class="bg-[#3E3E3E] text-white pt-12 pb-6 px-5">
                <div class="flex items-center gap-4 mb-6">
                    <div class="w-16 h-16 rounded-full bg-gray-200 border-2 border-white overflow-hidden">
                        <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?ixlib=rb-1.2.1&auto=format&fit=crop&w=200&q=80" class="w-full h-full object-cover">
                    </div>
                    <div>
                        <div class="text-xl font-bold mb-1">用户9527</div>
                        <div class="text-xs text-gray-400 bg-white/10 px-2 py-0.5 rounded-full inline-block">
                            申请认证 <i class="fa-solid fa-chevron-right text-[10px] ml-1"></i>
                        </div>
                    </div>
                </div>
                <div class="flex justify-between text-center">
                    <div><div class="font-bold text-lg">12</div><div class="text-xs text-gray-400">头条</div></div>
                    <div><div class="font-bold text-lg">348</div><div class="text-xs text-gray-400">关注</div></div>
                    <div><div class="font-bold text-lg">5.2w</div><div class="text-xs text-gray-400">粉丝</div></div>
                    <div><div class="font-bold text-lg">1024</div><div class="text-xs text-gray-400">获赞</div></div>
                </div>
            </div>
            
            <!-- Menu Grid -->
            <div class="bg-white mb-2 p-4">
                <div class="grid grid-cols-4 gap-y-6">
                    <div class="flex flex-col items-center gap-2">
                        <i class="fa-regular fa-bell text-xl text-[#F85959]"></i>
                        <span class="text-xs text-gray-600">消息通知</span>
                    </div>
                    <div class="flex flex-col items-center gap-2">
                        <i class="fa-regular fa-star text-xl text-[#FFB800]"></i>
                        <span class="text-xs text-gray-600">我的收藏</span>
                    </div>
                    <div class="flex flex-col items-center gap-2">
                        <i class="fa-solid fa-clock-rotate-left text-xl text-[#4A90E2]"></i>
                        <span class="text-xs text-gray-600">浏览历史</span>
                    </div>
                    <div class="flex flex-col items-center gap-2">
                        <i class="fa-solid fa-wallet text-xl text-[#F85959]"></i>
                        <span class="text-xs text-gray-600">钱包</span>
                    </div>
                </div>
            </div>

            <!-- List Menu -->
            <div class="bg-white flex-1">
                <div class="px-4 py-4 border-b border-sep flex justify-between items-center">
                    <span class="text-sm">用户反馈</span>
                    <i class="fa-solid fa-chevron-right text-gray-300 text-xs"></i>
                </div>
                <div class="px-4 py-4 border-b border-sep flex justify-between items-center">
                    <span class="text-sm">系统设置</span>
                    <i class="fa-solid fa-chevron-right text-gray-300 text-xs"></i>
                </div>
            </div>
        </div>

    </div>

    <!-- BOTTOM NAVIGATION -->
    <div class="h-[50px] border-t border-sep bg-white flex items-center justify-around text-[10px] z-50 pb-safe">
        <div class="flex flex-col items-center gap-1 w-full h-full justify-center cursor-pointer tab-active" onclick="switchTab('home', this)">
            <i class="fa-solid fa-house text-xl mb-[2px]"></i>
            <span>首页</span>
        </div>
        <div class="flex flex-col items-center gap-1 w-full h-full justify-center cursor-pointer tab-inactive" onclick="switchTab('video', this)">
            <i class="fa-brands fa-youtube text-xl mb-[2px]"></i>
            <span>视频</span>
        </div>
        <div class="flex flex-col items-center gap-1 w-full h-full justify-center cursor-pointer tab-inactive" onclick="switchTab('micro', this)">
            <i class="fa-regular fa-comment-dots text-xl mb-[2px]"></i>
            <span>微头条</span>
        </div>
        <div class="flex flex-col items-center gap-1 w-full h-full justify-center cursor-pointer tab-inactive" onclick="switchTab('profile', this)">
            <i class="fa-regular fa-user text-xl mb-[2px]"></i>
            <span>我的</span>
        </div>
    </div>

    <!-- ==================== OVERLAYS ==================== -->

    <!-- ARTICLE DETAIL VIEW (Slide Over) -->
    <div id="article-view" class="fixed inset-0 bg-white z-50 slide-out page-transition flex flex-col">
        <!-- Header -->
        <div class="h-12 border-b border-sep flex items-center px-2 justify-between bg-white">
            <div class="w-10 h-full flex items-center justify-center" onclick="closeArticle()">
                <i class="fa-solid fa-arrow-left text-gray-800 text-lg"></i>
            </div>
            <div class="flex-1 flex items-center justify-end gap-4 pr-2">
                <div class="flex items-center gap-2 mr-auto ml-2">
                    <img id="article-author-img" src="" class="w-7 h-7 rounded-full bg-gray-200">
                    <span id="article-author-name" class="text-sm font-medium text-title">Author</span>
                </div>
                <button class="bg-toutiao text-white text-xs px-4 py-1.5 rounded-[2px] font-medium">关注</button>
                <i class="fa-solid fa-ellipsis text-gray-600 px-2"></i>
            </div>
        </div>

        <!-- Content -->
        <div class="flex-1 overflow-y-auto p-5 pb-20" id="article-content-container">
            <h1 id="article-title" class="text-[22px] font-bold leading-[1.4] text-[#222222] mb-3">Article Title</h1>
            <div class="flex items-center gap-2 text-xs text-gray-400 mb-6">
                <span id="article-source">Source</span>
                <span>·</span>
                <span id="article-time">Time</span>
            </div>
            <div id="article-body" class="text-[17px] leading-[1.6] text-[#333333] space-y-4">
                <!-- Content injected here -->
            </div>
        </div>

        <!-- Footer Comment Bar -->
        <div class="h-12 border-t border-sep bg-white flex items-center px-4 gap-4 pb-safe">
            <div class="flex-1 bg-[#F4F5F6] h-8 rounded-full flex items-center px-4 text-gray-400 text-sm">
                <i class="fa-solid fa-pen mr-2 text-xs"></i> 写评论...
            </div>
            <div class="flex items-center gap-5 text-gray-600 text-lg">
                <div class="relative">
                    <i class="fa-regular fa-comment-dots"></i>
                    <span class="absolute -top-1 -right-2 bg-toutiao text-white text-[9px] px-1 rounded-full">128</span>
                </div>
                <i class="fa-regular fa-star"></i>
                <i class="fa-regular fa-thumbs-up"></i>
                <i class="fa-solid fa-share-nodes"></i>
            </div>
        </div>
    </div>

    <!-- SEARCH OVERLAY -->
    <div id="search-view" class="fixed inset-0 bg-white z-50 hidden flex flex-col">
        <div class="h-12 flex items-center px-3 gap-3 border-b border-sep">
            <div class="w-8 h-full flex items-center justify-center" onclick="closeSearch()">
                <i class="fa-solid fa-arrow-left text-gray-600"></i>
            </div>
            <div class="flex-1 bg-[#F4F5F6] h-8 rounded-[4px] flex items-center px-3">
                <i class="fa-solid fa-magnifying-glass text-gray-400 text-sm mr-2"></i>
                <input type="text" placeholder="搜索" class="bg-transparent border-none outline-none text-sm w-full" autofocus>
            </div>
            <div class="text-gray-600 text-sm font-medium" onclick="closeSearch()">搜索</div>
        </div>
        <div class="p-4">
            <div class="text-sm font-bold text-gray-400 mb-3">历史记录</div>
            <div class="flex flex-wrap gap-2">
                <span class="px-3 py-1 bg-[#F4F5F6] text-xs text-gray-600 rounded-[2px]">DeepSeek 教程</span>
                <span class="px-3 py-1 bg-[#F4F5F6] text-xs text-gray-600 rounded-[2px]">今日金价</span>
                <span class="px-3 py-1 bg-[#F4F5F6] text-xs text-gray-600 rounded-[2px]">新能源汽车降价</span>
            </div>
            <div class="text-sm font-bold text-gray-400 mb-3 mt-6">猜你想搜</div>
            <div class="space-y-3">
                <div class="flex items-center gap-3">
                    <span class="text-[#F85959] font-bold text-sm w-4">1</span>
                    <span class="text-sm text-[#222222]">国产大模型最新进展</span>
                    <span class="text-[10px] bg-[#F85959] text-white px-1 rounded-[2px]">热</span>
                </div>
                <div class="flex items-center gap-3">
                    <span class="text-[#F85959] font-bold text-sm w-4">2</span>
                    <span class="text-sm text-[#222222]">2025年放假安排</span>
                </div>
                <div class="flex items-center gap-3">
                    <span class="text-[#F85959] font-bold text-sm w-4">3</span>
                    <span class="text-sm text-[#222222]">SpaceX 星舰发射</span>
                    <span class="text-[10px] bg-[#FFB800] text-white px-1 rounded-[2px]">新</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- DATA ---
        const CHANNELS = ["推荐", "热榜", "视频", "科技", "娱乐", "体育", "财经", "军事", "国际", "时尚", "游戏", "汽车", "房产"];
        
        const FEED_DATA = [
            {
                id: 1,
                type: 'text',
                title: '央视新闻：2025年中国经济开局良好，GDP增速超预期',
                author: '央视新闻',
                comments: '1.2w',
                time: '5分钟前',
                isTop: true
            },
            {
                id: 2,
                type: 'img-3',
                title: '实拍：SpaceX星舰第五次试飞成功，回收画面震撼全球',
                images: [
                    'https://images.unsplash.com/photo-1517976487492-5750f3195933?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60',
                    'https://images.unsplash.com/photo-1451187580459-43490279c0fa?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60',
                    'https://images.unsplash.com/photo-1446776811953-b23d57bd21aa?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60'
                ],
                author: '科技前沿',
                comments: '8521',
                time: '23分钟前'
            },
            {
                id: 3,
                type: 'img-right',
                title: '为什么现在的年轻人都不爱换手机了？数据揭示真相',
                image: 'https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60',
                author: '数码闲聊站',
                comments: '3402',
                time: '1小时前'
            },
            {
                id: 4,
                type: 'video',
                title: '【纪录片】舌尖上的中国：寻找失传的传统美食',
                image: 'https://images.unsplash.com/photo-1504674900247-0877df9cc836?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=60',
                duration: '12:34',
                author: '美食作家王刚',
                comments: '5600',
                time: '2小时前'
            },
            {
                id: 5,
                type: 'text',
                title: '刚刚，油价又变了！明晚24时开启新一轮调整',
                author: '财经早餐',
                comments: '99+',
                time: '3小时前'
            },
            {
                id: 6,
                type: 'img-right',
                title: '旅行攻略：川西最美环线，这几个地方一定要去',
                image: 'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60',
                author: '远方旅行',
                comments: '450',
                time: '4小时前'
            },
            {
                id: 7,
                type: 'img-3',
                title: '这才是真正的豪宅！带你参观价值1.5亿的苏州园林别墅',
                images: [
                    'https://images.unsplash.com/photo-1600596542815-2250c385528c?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60',
                    'https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60',
                    'https://images.unsplash.com/photo-1600566753190-17f0baa2a6c3?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60'
                ],
                author: '房产观察',
                comments: '1.1w',
                time: '5小时前'
            }
        ];

        const VIDEO_DATA = [
            {
                title: "荒野求生：在无人岛生存的第100天",
                author: "探险家老李",
                views: "120万次播放",
                cover: "https://images.unsplash.com/photo-1533240332313-0db49b459ad6?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=60",
                duration: "15:20"
            },
            {
                title: "这只猫咪成精了！竟然会自己开门",
                author: "萌宠日记",
                views: "85万次播放",
                cover: "https://images.unsplash.com/photo-1514888286974-6c03e2ca1dba?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=60",
                duration: "03:45"
            },
            {
                title: "程序员的真实一天：代码、咖啡与Bug",
                author: "极客时间",
                views: "45万次播放",
                cover: "https://images.unsplash.com/photo-1498050108023-c5249f4df085?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=60",
                duration: "08:12"
            }
        ];

        const MICRO_DATA = [
            {
                author: "雷军",
                avatar: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-1.2.1&auto=format&fit=crop&w=100&q=60",
                content: "今天是个好日子！小米汽车SU7 Ultra原型车在纽北刷圈成绩出来了，6分46秒874！这是奇迹！感谢所有米粉的支持！#小米汽车 #纽北",
                images: ["https://images.unsplash.com/photo-1552519507-da3b142c6e3d?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60"],
                likes: "10w+",
                comments: "5000"
            },
            {
                author: "罗永浩",
                avatar: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-1.2.1&auto=format&fit=crop&w=100&q=60",
                content: "在这个喧嚣的世界里，保持独立思考的能力比什么都重要。今晚8点直播间见，聊聊最近的科技圈怪象。",
                images: [],
                likes: "2.3w",
                comments: "1200"
            }
        ];

        // --- RENDER FUNCTIONS ---

        function init() {
            renderChannels();
            renderFeed();
            renderVideoFeed();
            renderMicroFeed();
        }

        function renderChannels() {
            const container = document.getElementById('channel-list');
            CHANNELS.forEach((channel, index) => {
                const el = document.createElement('div');
                el.className = `whitespace-nowrap cursor-pointer ${index === 0 ? 'channel-active' : 'channel-inactive'}`;
                el.innerText = channel;
                el.onclick = () => {
                    document.querySelectorAll('#channel-list div').forEach(d => {
                        d.className = 'whitespace-nowrap cursor-pointer channel-inactive';
                    });
                    el.className = 'whitespace-nowrap cursor-pointer channel-active';
                };
                container.appendChild(el);
            });
        }

        function renderFeed() {
            const container = document.getElementById('home-feed');
            FEED_DATA.forEach(item => {
                const el = document.createElement('div');
                el.className = 'border-b border-sep px-4 py-3 active:bg-gray-50';
                el.onclick = () => openArticle(item);

                let contentHtml = '';
                const metaHtml = `
                    <div class="flex items-center gap-2 mt-2 text-[10px] text-meta">
                        ${item.isTop ? '<span class="text-toutiao border border-toutiao px-1 rounded-[2px]">置顶</span>' : ''}
                        <span>${item.author}</span>
                        <span>${item.comments}评论</span>
                        <span>${item.time}</span>
                    </div>
                `;

                if (item.type === 'text') {
                    contentHtml = `
                        <div class="text-[17px] leading-[1.4] font-medium text-title line-clamp-2">${item.title}</div>
                        ${metaHtml}
                    `;
                } else if (item.type === 'img-right') {
                    contentHtml = `
                        <div class="flex gap-3">
                            <div class="flex-1">
                                <div class="text-[17px] leading-[1.4] font-medium text-title line-clamp-3">${item.title}</div>
                                ${metaHtml}
                            </div>
                            <div class="w-[110px] h-[74px] bg-gray-100 flex-shrink-0">
                                <img src="${item.image}" class="w-full h-full object-cover rounded-[2px]">
                            </div>
                        </div>
                    `;
                } else if (item.type === 'img-3') {
                    contentHtml = `
                        <div class="text-[17px] leading-[1.4] font-medium text-title line-clamp-2 mb-2">${item.title}</div>
                        <div class="grid grid-cols-3 gap-1 mb-2">
                            ${item.images.map(img => `
                                <div class="aspect-[4/3] bg-gray-100">
                                    <img src="${img}" class="w-full h-full object-cover rounded-[2px]">
                                </div>
                            `).join('')}
                        </div>
                        ${metaHtml}
                    `;
                } else if (item.type === 'video') {
                    contentHtml = `
                        <div class="text-[17px] leading-[1.4] font-medium text-title line-clamp-2 mb-2">${item.title}</div>
                        <div class="relative aspect-video bg-black rounded-[2px] overflow-hidden mb-2">
                            <img src="${item.image}" class="w-full h-full object-cover opacity-80">
                            <div class="absolute inset-0 flex items-center justify-center">
                                <div class="w-10 h-10 rounded-full bg-black/50 flex items-center justify-center backdrop-blur-sm">
                                    <i class="fa-solid fa-play text-white ml-1"></i>
                                </div>
                            </div>
                            <div class="absolute bottom-2 right-2 bg-black/60 text-white text-[10px] px-1.5 py-0.5 rounded-full">
                                ${item.duration}
                            </div>
                        </div>
                        ${metaHtml}
                    `;
                }

                el.innerHTML = contentHtml;
                container.appendChild(el);
            });
        }

        function renderVideoFeed() {
            const container = document.getElementById('video-feed');
            VIDEO_DATA.forEach(item => {
                const el = document.createElement('div');
                el.className = 'mb-2 bg-[#1a1a1a] pb-3';
                el.innerHTML = `
                    <div class="relative aspect-video bg-black">
                        <img src="${item.cover}" class="w-full h-full object-cover">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <i class="fa-regular fa-circle-play text-white text-5xl opacity-80"></i>
                        </div>
                        <div class="absolute bottom-2 right-2 bg-black/60 text-white text-xs px-2 py-0.5 rounded">
                            ${item.duration}
                        </div>
                        <div class="absolute top-0 left-0 w-full h-16 bg-gradient-to-b from-black/60 to-transparent p-3">
                            <div class="text-white text-lg font-medium line-clamp-2">${item.title}</div>
                        </div>
                    </div>
                    <div class="px-3 pt-3 flex justify-between items-center">
                        <div class="flex items-center gap-2">
                            <div class="w-8 h-8 rounded-full bg-gray-700 overflow-hidden">
                                <img src="https://ui-avatars.com/api/?name=${item.author}&background=random" class="w-full h-full">
                            </div>
                            <span class="text-gray-300 text-sm">${item.author}</span>
                        </div>
                        <div class="flex gap-4 text-gray-400">
                            <i class="fa-regular fa-heart"></i>
                            <i class="fa-regular fa-comment-dots"></i>
                            <i class="fa-solid fa-ellipsis-vertical"></i>
                        </div>
                    </div>
                `;
                container.appendChild(el);
            });
        }

        function renderMicroFeed() {
            const container = document.getElementById('micro-feed');
            MICRO_DATA.forEach(item => {
                const el = document.createElement('div');
                el.className = 'bg-white mb-2 p-4';
                el.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <div class="flex gap-3">
                            <img src="${item.avatar}" class="w-10 h-10 rounded-full">
                            <div>
                                <div class="font-bold text-[#222222]">${item.author}</div>
                                <div class="text-xs text-gray-400">2小时前 · 来自 iPhone 16 Pro</div>
                            </div>
                        </div>
                        <button class="text-toutiao border border-toutiao text-xs px-3 py-1 rounded-full font-medium">+ 关注</button>
                    </div>
                    <div class="text-[16px] leading-[1.6] text-[#222222] mb-3">
                        ${item.content}
                    </div>
                    ${item.images.length > 0 ? `
                    <div class="mb-3">
                        <img src="${item.images[0]}" class="max-h-[200px] rounded-[4px]">
                    </div>` : ''}
                    <div class="flex justify-between border-t border-sep pt-3 text-gray-500 text-sm">
                        <div class="flex items-center gap-1"><i class="fa-solid fa-share-nodes"></i> 转发</div>
                        <div class="flex items-center gap-1"><i class="fa-regular fa-comment-dots"></i> ${item.comments}</div>
                        <div class="flex items-center gap-1"><i class="fa-regular fa-thumbs-up"></i> ${item.likes}</div>
                    </div>
                `;
                container.appendChild(el);
            });
        }

        // --- INTERACTION FUNCTIONS ---

        function switchTab(tabName, el) {
            // Update Tab UI
            document.querySelectorAll('.tab-active').forEach(t => {
                t.classList.remove('tab-active');
                t.classList.add('tab-inactive');
                t.querySelector('i').classList.remove('fa-solid'); // Reset icons if needed, simplified here
            });
            el.classList.remove('tab-inactive');
            el.classList.add('tab-active');

            // Hide all views
            ['home', 'video', 'micro', 'profile'].forEach(v => {
                document.getElementById(`view-${v}`).classList.add('hidden');
            });

            // Show target view
            document.getElementById(`view-${tabName}`).classList.remove('hidden');
        }

        function openArticle(item) {
            const view = document.getElementById('article-view');
            
            // Populate Data
            document.getElementById('article-title').innerText = item.title;
            document.getElementById('article-author-name').innerText = item.author;
            document.getElementById('article-author-img').src = `https://ui-avatars.com/api/?name=${item.author}&background=random`;
            document.getElementById('article-source').innerText = item.author;
            document.getElementById('article-time').innerText = item.time;
            
            // Generate Dummy Body Content
            const body = document.getElementById('article-body');
            body.innerHTML = `
                <p><strong>（${item.author} 讯）</strong> 这里是新闻正文内容。今日头条致力于为用户提供精准的个性化推荐服务。</p>
                <p>随着移动互联网的发展，信息获取的方式发生了翻天覆地的变化。用户不再被动接受信息，而是通过算法推荐获取感兴趣的内容。</p>
                ${item.image ? `<img src="${item.image}" class="w-full rounded-[4px] my-4">` : ''}
                ${item.images ? `<img src="${item.images[0]}" class="w-full rounded-[4px] my-4">` : ''}
                <p>据最新数据显示，该事件引起了广泛关注。专家表示，这标志着行业发展进入了新的阶段。</p>
                <p>我们采访了多位业内人士，他们普遍认为，未来的趋势将更加注重用户体验和内容质量。</p>
                <p class="text-sm text-gray-400 mt-8">责任编辑：${item.author}编辑部</p>
            `;

            // Show View
            view.classList.remove('slide-out');
            view.classList.add('slide-in');
        }

        function closeArticle() {
            const view = document.getElementById('article-view');
            view.classList.remove('slide-in');
            view.classList.add('slide-out');
        }

        function openSearch() {
            document.getElementById('search-view').classList.remove('hidden');
        }

        function closeSearch() {
            document.getElementById('search-view').classList.add('hidden');
        }

        // --- SCROLL & REFRESH LOGIC ---

        function setupInfiniteScroll() {
            const feed = document.getElementById('home-feed');
            feed.addEventListener('scroll', () => {
                if (feed.scrollTop + feed.clientHeight >= feed.scrollHeight - 100) {
                    // Load more
                    loadMoreItems();
                }
            });
        }

        function loadMoreItems() {
            // Simulate network delay
            setTimeout(() => {
                // Duplicate random items from FEED_DATA
                const randomItems = FEED_DATA.sort(() => 0.5 - Math.random()).slice(0, 3);
                const container = document.getElementById('home-feed');
                
                randomItems.forEach(item => {
                    const el = document.createElement('div');
                    el.className = 'border-b border-sep px-4 py-3 active:bg-gray-50 fade-in';
                    el.onclick = () => openArticle(item);
                    
                    // Re-use render logic (simplified for brevity, ideally refactor renderFeed to return HTML)
                    // We will just copy the innerHTML generation logic here or refactor.
                    // Let's just call a helper to get HTML string.
                    el.innerHTML = getFeedItemHTML(item);
                    container.appendChild(el);
                });
            }, 500);
        }

        function getFeedItemHTML(item) {
            let contentHtml = '';
            const metaHtml = `
                <div class="flex items-center gap-2 mt-2 text-[10px] text-meta">
                    <span>${item.author}</span>
                    <span>${item.comments}评论</span>
                    <span>${item.time}</span>
                </div>
            `;

            if (item.type === 'text') {
                return `<div class="text-[17px] leading-[1.4] font-medium text-title line-clamp-2">${item.title}</div>${metaHtml}`;
            } else if (item.type === 'img-right') {
                return `
                    <div class="flex gap-3">
                        <div class="flex-1">
                            <div class="text-[17px] leading-[1.4] font-medium text-title line-clamp-3">${item.title}</div>
                            ${metaHtml}
                        </div>
                        <div class="w-[110px] h-[74px] bg-gray-100 flex-shrink-0">
                            <img src="${item.image}" class="w-full h-full object-cover rounded-[2px]">
                        </div>
                    </div>`;
            } else if (item.type === 'img-3') {
                return `
                    <div class="text-[17px] leading-[1.4] font-medium text-title line-clamp-2 mb-2">${item.title}</div>
                    <div class="grid grid-cols-3 gap-1 mb-2">
                        ${item.images.map(img => `<div class="aspect-[4/3] bg-gray-100"><img src="${img}" class="w-full h-full object-cover rounded-[2px]"></div>`).join('')}
                    </div>
                    ${metaHtml}`;
            } else if (item.type === 'video') {
                return `
                    <div class="text-[17px] leading-[1.4] font-medium text-title line-clamp-2 mb-2">${item.title}</div>
                    <div class="relative aspect-video bg-black rounded-[2px] overflow-hidden mb-2">
                        <img src="${item.image}" class="w-full h-full object-cover opacity-80">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-10 h-10 rounded-full bg-black/50 flex items-center justify-center backdrop-blur-sm">
                                <i class="fa-solid fa-play text-white ml-1"></i>
                            </div>
                        </div>
                        <div class="absolute bottom-2 right-2 bg-black/60 text-white text-[10px] px-1.5 py-0.5 rounded-full">${item.duration}</div>
                    </div>
                    ${metaHtml}`;
            }
            return '';
        }

        function setupPullToRefresh() {
            const feed = document.getElementById('home-feed');
            const spinner = document.getElementById('refresh-spinner');
            let startY = 0;
            let isPulling = false;

            feed.addEventListener('touchstart', (e) => {
                if (feed.scrollTop === 0) {
                    startY = e.touches[0].pageY;
                    isPulling = true;
                }
            });

            feed.addEventListener('touchmove', (e) => {
                if (!isPulling) return;
                const y = e.touches[0].pageY;
                const diff = y - startY;
                if (diff > 0 && diff < 100) {
                    // Visual feedback could go here
                }
            });

            feed.addEventListener('touchend', (e) => {
                if (!isPulling) return;
                const y = e.changedTouches[0].pageY;
                if (y - startY > 60) {
                    // Trigger refresh
                    spinner.classList.remove('hidden');
                    setTimeout(() => {
                        spinner.classList.add('hidden');
                        // Prepend new item
                        const newItem = FEED_DATA[Math.floor(Math.random() * FEED_DATA.length)];
                        const el = document.createElement('div');
                        el.className = 'border-b border-sep px-4 py-3 active:bg-gray-50 bg-red-50 transition-colors duration-1000';
                        el.onclick = () => openArticle(newItem);
                        el.innerHTML = getFeedItemHTML(newItem);
                        feed.insertBefore(el, feed.children[1]); // Insert after spinner
                        
                        // Remove highlight after 1s
                        setTimeout(() => el.classList.remove('bg-red-50'), 1000);
                    }, 1500);
                }
                isPulling = false;
            });
        }

        // Initialize
        init();
        setupInfiniteScroll();
        setupPullToRefresh();

    </script>
</body>
</html>